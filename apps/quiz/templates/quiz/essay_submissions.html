{% extends 'base.html' %}

{% block content %}
<div class="container" style="padding: 2rem 0;">
    <div class="card" style="max-width: 800px; margin: 0 auto;">
        <h1>Essay Submissions for {{ quiz.title }}</h1>

        <div style="margin-bottom: 2rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem;">
            <a href="{% url 'quiz_detail' quiz.pk %}"
                style="display: inline-flex; align-items: center; gap: 0.5rem; color: var(--text-muted); text-decoration: none; margin-bottom: 1rem;">
                &larr; Back to Quiz
            </a>
            <h1>Essay Submissions for {{ quiz.title }}</h1>
        </div>

        {% for submission in submissions %}
        <div class="card" style="margin-bottom: 1rem;">
            <h2>{{ submission.question.text }}</h2>
            <p><strong>Student:</strong> {{ submission.submission.student.username }}</p>
            <p><strong>Answer:</strong> {{ submission.answer }}</p>
            
            <div style="background-color: #f0f0f0; padding: 1rem; border-radius: 5px; margin-top: 1rem;">
                <h4>AI Feedback</h4>
                <p><strong>AI Score:</strong> {{ submission.ai_score }}</p>
                <p>{{ submission.ai_feedback }}</p>
            </div>

            <form action="{% url 'quiz_essay_submissions' quiz.pk %}" method="post" style="margin-top: 1rem; display: flex; gap: 1rem; align-items: center;">
                {% csrf_token %}
                <input type="hidden" name="submission_id" value="{{ submission.pk }}">
                <label for="score_{{ submission.pk }}">Your Score:</label>
                <input type="number" name="score" id="score_{{ submission.pk }}" value="{{ submission.instructor_score|default_if_none:'' }}" min="0" max="100" style="padding: 0.5rem; border: 1px solid var(--border); border-radius: var(--radius-sm); width: 80px;">
                <button type="submit" class="btn btn-primary" style="padding: 0.5rem 1rem;">Save Score</button>
            </form>
        </div>
        {% empty %}
        <p>No essay submissions for this quiz yet.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
